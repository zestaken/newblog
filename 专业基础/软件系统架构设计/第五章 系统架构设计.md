---
title: 第五章 系统架构设计
date: 2021-11-01 11:23:19
tags: [软件工程, 软件系统架构设计]
categories: 专业基础
---

# 系统设计概述

## 系统设计概念与过程

* 系统设计概念：系统设计是指*在系统需求分析的基础上*，运用软件工程的思想与方法，设计出能满足系统需求目标的新系统构造方案的活动。
* 系统设计过程：
  * 需求分析
  * 总体设计（架构设计）
  * 详细设计
  * 实现与测试
  ![3kX660](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/3kX660.png)

## 系统设计活动

* 系统架构设计：在系统架构设计中，需要对系统的*总体架构、网络拓扑结构、软件架构、数据架构和应用架构*等方面进行设计。
* 基础设施平台设计：在系统总体设计时，还需考虑信息系统的运行环境设计，即基础设施平台设计。在基础设施平台设计中，除了考虑*系统的网络结构、网络结点通信关系、硬件计算资源能力、硬件存储资源能力*设计外，还需要考虑系统*运行软件环境设计*，如操作系统软件、数据库系统软件、应用中间件等。
* 系统构件设计：系统构件设计是对系统的组成构件进行设计，确定出*系统构件功能逻辑、构件接口*等。
* 系统界面设计：界面设计是对人和外部系统与信息系统之间交互界面设计。它包括操作界面、表单、报表、系统接口等要素设计。
* 系统数据库设计：数据库设计是指根据特定的系统应用需求，设计出合理的系统数据库结构。数据库设计需要经过*概念设计、逻辑设计和物理设计*等步骤。
* 程序流程设计：程序流程设计是对构件内部功能逻辑进行设计，确定*算法程序流程及其数据结构*。
* 安全机制设计：安全机制设计是对系统与数据的*安全访问、隐私保护等*安全措施与手段进行设计。
![CnkD9l](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/CnkD9l.png)

## 系统设计思想

* 抽象化：
  * 抽象是在系统规模大、逻辑复杂的情况下，*降低系统设计复杂性*的基本策略。 
  * 抽象的过程是从特殊到一般的过程，上层概念是下层概念的抽象。通过抽象*实现系统设计建模*。
* 逐步求精：
  * 把问题的求解过程分解成若干步骤或阶段，每步都比上步更精化，更接近问题的解法。
  * 抽象使得设计者能在宏观层面描述过程和数据而忽略低层的细节，而求精有助于设计者在*微观层面设计低层技术细节*。
* 模块化：
  * 模块化，即把一个大系统按照特定规则，*划分为若干较小的，又相互关联的部件*，以便将复杂问题分解为简单问题进行解决。
  * 模块是*数据说明、可执行语句等程序对象的集合*。它是单独命名的、可以通过名字来访问的功能部件，如程序的过程、函数、子程序、宏等。
* 信息隐藏：
  * 每个模块的实现细节对于其它模块来说应该是隐蔽的，模块之间实现*松耦合*，以便实现软件构件的*可复用性*。
  * 模块中所包含的信息(包括数据和过程)只能通过*接口访问*，以便支持模块的*可维护性*。
* 模块独立：
  * 模块完成独立的功能，并且与其他模块通过接口关联，符合信息隐蔽和信息局部化原则，模块间*关联和依赖程度尽可能小*。
  * 模块独立便于*功能被划分*，更易于开发和维护。
  * 模块独立性可以由两项指标来衡量:*内聚度与耦合度*。

## 系统设计原则和方法

* 设计原则：
  * 建立良好的系统*体系架构*，以满足系统的可靠性、安全性、可伸缩性、可维护性等非功能特性需求。
  * 系统设计应采取*模型抽象、模块化设计*，将复杂系统分解为较简单的子系统及其构件进行开发。
  * 采用*标准建模语言方式*直观、明确地表达设计思路，对系统架构、应用架构、软件架构、数据架构、系统构件、用户界面、程序逻辑等设计内容采用*可视化模型*表示。
* 设计方法：
  ![gNxUnI](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/gNxUnI.png)

## 面向对象系统分析与设计建模过程

* 需求建模
* 系统分析建模
* 系统总体设计建模
* 系统详细设计建模
![X0zoMQ](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/X0zoMQ.png)

# 系统架构基础

## 系统架构概述

* 系统架构概念：系统架构(又称系统体系架构)是指系统的组成结构模式，它由反映系统部件的*关联性、交互性和约束机制*进行描述。
* 系统架构设计：系统架构设计根据系统需求，从*不同层面、不同视角*给出系统总体框架的设计蓝图。
* 系统架构作用：
  * 系统架构反映系统设计总体框架，有利于开发者围绕系统设计进行*交流与讨论*。
  * 系统架构体现系统设计*策略*，它对系统开发工作有深远的影响。
  * 系统架构决定了系统*非功能特性*，如系统可靠性、可用性、安全性、可伸缩性，以及系统性能。
* 系统架构类型：
  * 总体架构
  * 应用架构
  * 软件架构
  * 数据架构
  * 拓扑架构
  ![2r1fH5](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/2r1fH5.png)

## 系统总体架构

* 总体架构：系统总体架构是从全局层面给出系统各种组成要素之间结构关系。它通常包括*基础设施、运行平台、应用软件、业务部门、信息数据以及用户*等。
* 示例1：
  ![j61aYK](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/j61aYK.png)
* 示例2:
  ![nXI5wF](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/nXI5wF.png)

## 系统拓扑架构

* 系统拓扑结构是指从*系统基础设施平台层面描述节点与节点之间的通信连接关系*。节点是指系统中处理逻辑相对独立的物理实体，如PC计算机、服务器、外围设备等。
* 系统拓扑结构设计是从系统基础设施平台层面，给出*系统节点在网络环境中的结构关系*，包括节点分布、节点类型节点运行环境以及节点之间的通信联系。
* 示例：
    ![auQmH1](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/auQmH1.png)

## 系统数据架构

* 系统数据架构是指从数据管理视角所描述的系统架构，它通常用来反映各类*数据资源的组织与存储*。
* 系统数据架构不仅需要反映机构的*数据结点分布关系*。还需要考虑数据资源的*存储结构与存储方式*，如文件存储、数据库存储或数据仓库存储。
* 系统数据分层架构设计：在大数据应用系统中，按照数据不同处理要求，可以将它们组织到不同层次的数据管理系统进行计算与分析处理。
  ![uGB2xN](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/uGB2xN.png)
* 系统数据治理架构设计：在信息系统中，数据资源结点一般是按照业务管理的需求，将它们部署到*不同业务部门*服务器进行数据存储与访问管理。系统数据*治理架构与组织机构的数据管理职能*有直接关系。
  ![7OSBWp](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/7OSBWp.png)
* 系统数据存储架构设计：在信息系统中，一些数据资源需要采用文件系统存储，另外一些数据资源需要采用数据库系统存储，还有一些数据资源则需要数据仓库系统进行数据存储。每类*存储系统*在设计上需要满足应用需求，如支持高可用、高性能的存取访问。
    ![xDmMLJ](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/xDmMLJ.png)
* 示例：
  ![MVFzzG](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/MVFzzG.png)

## 系统应用架构

* 系统应用架构是指从应用功能视角所描述的系统架构。系统应用架构关注*应用功能划分、应用功能配置、服务访问、服务管理*等要素。
* 示例：
  ![sQIccC](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/sQIccC.png)

## 软件体系架构

* 软件体系架构(简称软件架构)是一种从软件视角所描述的系统架构，它对软件系统的结构、行为进行高层抽象，一般通过*构件、连接件、配置、端口、角色*等图符元素进行描述。
* 基本元素：
  * 构件(component) :具有特定功能的、可重用的*软件模块*。
  * 连接件(connector) :用以表示*构件之间的交互*，如过程调用、事件广播、交互协议等。
  * 配置(configuration) :用于对构件与连接件的*拓扑逻辑、语义约束*等说明。
  * 端口(port) :表示*构件接口与外部环境*的交互点。
  * 角色(role) :*连接件的参与者*，如事件消息的发布者与接受者。
* 软件架构设计是指基于一定的设计原则和系统需求，从软件角度对组成系统的各部分进行划分和组织，设计系统的构件组成结构及其构件之间的相互关系。
* 软件架构设计目标：在软件架构设计中，除了满足系统功能需求外，还应满足系统非功能需求，即达到如下质量目标。
  * 可靠性(Reliable):软件系统具有可靠运行的能力。
  * 安全性(Secure):软件系统具有安全运行的能力。
  * 可伸缩性(Scalable):软件 系统具有在用户访问量、并发用户数发生变化情况下，保持合理运行性能和资源利用率的能力。
  * 定制化(Customizable):软件系统具有个性化系统功能定制的能力。
  * 可扩展性(Extensible):具有对系统进行功能和性能扩展的能力。
  * 可维护性(Ma intainable):具有进行软件修改或 软件进化的能力。
* 示例：
  ![Bn4VPB](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/Bn4VPB.png)

# 软件架构风格

## 软件架构风格概述

* 软件架构风格是指针对不同系统共性问题提供一般性可重用的软件架构解决方案，它反映了领域中众多系统所*共有的软件结构及其模式*。
* 软件架构风格应用意义：
  * 定义了一类软件系统架构的要素和一组指导系统架构设计的规则。可促进*软件系统设计的复用*，使得一些经过实践验证的软件架构方案能够可靠地解决新问题。
  * 通过对标准软件架构风格的应用可支持*不同系统之间互操作性*，以便于实现系统集成。
  * 在特定设计空间下，便于*对软件系统相关设计作出分析*。
* 软件架构风格分类：
  * 数据流风格: 批处理序列架构、管道/过滤器架构
  * 调用/返回风格: 主程序/子程序架构、面向对象架构、分层体系架构
  * 独立构件风格: 进程通讯架构、事件驱动架构
  * 虚拟机风格: 解释器架构、基于规则的系统架构
  * 客户/服务器风格: 客户/服务器架构、浏览器/服务器架构
  * 面向服务风格: 面向服务架构(SOA) 、 微服务架构.
  * 仓库风格: 数据共享体系架构、黑板系统架构

## 分层体系架构

* 分层体系架构采用层次化方式组织功能构件，*每一层都是为上一层提供服务，并使用下一层提供的功能服务*。
* 将软件系统分成若干个水平层，每一层都有*清晰的功能处理分工*，各层不需要知道其他层的细节，*层与层之间仅通过接口通信*。
* 用户对软件系统的访问请求将依次通过各层功能逻辑构件进行处理，*不允许跳过其中任何层*。
* 示例：
  ![k6tYbW](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/k6tYbW.png)
* 优点：
  * 便于复杂系统设计，使整体设计更加*简洁与清晰*。
  * 支持系统*功能扩展设计*，每层的功能修改最多只影响相邻层。
  * 只要给相邻层提供标准接口，就可实现*功能复用*。
* 缺点:
  * 并不是每个系统都可以很*容易地划分层次*，此外，层次的划分还没有统一的方法。
  * 层次过多，会造成系统*性能降低*。
  * 当用户请求大量增加时，必须依次扩展每一层处理能力。如果*某层的内部是耦合的，系统扩展较困难*。

## 数据共享体系架构

* 数据共享体系架构是一种以*数据存储服务器为中心*，为客户软件提供数据共享、数据交换访问的软件架构风格。
* 在数据共享体系架构中，各个客户软件相互独立，它们*通过共享数据存储实现数据交换*。
* 一个客户软件对共享数据进行了修改，其他客户软件可以获得*数据变更*信息。
* 示例：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101164026.png)
* 优点：
  * 体系*架构简单*，容易实现软件开发。
  * 可有效地实现*大量数据共享*，新客户软件加入系统，无须考虑其他客户软件的存在。
  * 只要遵循*共享数据访问接口，各个客户软件可以独立执行*。
* 缺点：
  * 当共享数据结构发生变化，各客户软件都需要进行*数据访问调整*，通常比较麻烦。
  * 当客户软件大量增加时，*共享数据存储服务器将面临性能压力*。
  * 共享数据存储服务器作为系统的中央单元，若没有考虑高可用性方案，它*一旦故障*将导致整个系统无法运行。
  * 共享数据存储难以实现*分布式处理*。

## 事件驱动体系架构

* 事件驱动体系架构是一种基于*事件与消息机制实现软件构件之间进行通信*的软件架构。
* 构件(子系统)之间并不直接交互，而是*通过触发一个或多个事件，隐式调用另一构件*执行。
* 系统各构件需要在消息处理器中*注册相关事件，一旦事件触发，将隐含调用注册构件*进行处理，并将处理结果返回事件发布构件。
* 基本模型：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101170553.png)
* 示例:
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101170624.png)
* 优点：
  * 具有良好的*可扩展性*。通过注册可引入新的构件，而不影响现有构件。
  * 便于*软件维护*。只要构件名及其接口不变，可以用一个构件代替另一个构件。
  * 构件之间*耦合性低*，容易实现软件重用。
* 缺点：
  * 事件驱动*削弱了构件对系统的控制能力*。一个构件事件触发时，并不能保证其它构件会对其进行事件响应。
  * 消息传送机制不能很好地解决*数据交换问题*。

## 客户机/服务器软件架构

* 客户机/服务器软件架构是一种典型的分布系统体系架构，其*软件分为客户端构件和服务端构件*，客户端构件通常在客户机上运行，服务端构件在服务器上运行。
* 客户机/服务器架构采用*分布式系统模式*，它通常将界面展示、应用逻辑与数据存取构件分布在多个节点机上进行处理。
* 客户端构件为完成特定功能，需要*向服务端构件发出请求*。服务端构件*接收客户端构件请求*进行处理，并将结果返回请求者。
* 模式图：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101171526.png)
* C/S架构：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101171721.png)
  * 优点：
    * 可实现分布式计算处理，有利于*系统负载分担*。
    * 交互性强、具有安全的存取模式、响应速度快、利于处理大量数据。
  * 缺点：
    * 缺少*通用性*，系统维护、升级需要重新安装部署，增加了维护和管理的难度。
* B/S架构：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101172009.png)
  * 优点:
    * 分布性强:服务器可以在任何地点运行。
    * 访问方便:只要有网络、浏览器，就可以对系统应用进行访问。.
    * 系统处理负载能力强:可以将负载分布在Web服务器、应用服务器、数据库服务器处理。此外，通过负载均衡、集群技术可以支持更大负载处理。
    * 系统运维方便:只需要在服务器进行功能修改与发布，即可实现所有用户访问的同步更新。
    * 用户共享性强:可以支持不同地点用户共享访问系统。
  * 缺点：
    * 个性化处理、人机交互性能不如C/S架构软件。
    * 在系统*安全性设计*需要考虑更多内容。

## 微核体系架构

* 微核体系架构又称为*插件架构*，系统基本核心功能在软件内核中实现，其功能较少，系统大部分功能和业务逻辑都通过插件实现。
* 微核体系架构将待开发的目标软件分为软件*内核和插件*两个部分。
* 内核实现软件的*基本核心功能和插件管理功能*。
* 插件实现软件功能的运行时扩展与补充它是一种按照*统一插件接口规范*实现的功能程序。
* 基本模式：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101173232.png)
* 优点：
  * 良好的*功能扩展性*，需要什么功能，开发一个插件即可。
  * *插件之间是隔离的*，可以独立的加载和卸载，使得它比较容易部署。
  * 可*定制性高*，适应不同的开发需要。
  * 可以*渐进式*地开发，逐步增加功能插件。
* 缺点：
  * *伸缩性差*，内核通常是一个独立单元，不容易做成分布式。
  * 开发*难度*相对较高，因为涉及到插件与内核的通信，以及内部的插件登记机制。

## 微服务架构

* 微服务架构(microservices architecture) 是面向服务架构( service-oriented architecture,*SOA*)的轻量级实现版本。
* 将应用*软件划分成一组小型服务*，服务之间相互协调与配合，为用户提供功能服务。
* 每个*服务运行在独立的进程中*，服务之间采用轻量级通信机制进行消息交互。
* 每个服务都围绕业务进行构建，并且能够独立部署到运行环境。
* 这些服务都是*分布式的，互相解耦*，通过标准通信协议(如REST、 SOAP) 进行交互。
* 基本模式：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101173825.png)
* 示例：
  ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211101173856.png)
* 优点：
  * *扩展性*好，各个服务之间低耦合。
  * 容易*部署*，软件从整体部署拆分成多个独立功能服务进行部署，可以分别进行服务部署。
  * 容易开发，每个服务都可以进行*持续迭代开发*，可以做到实时部署，不间断地升级。
  * 易于测试，每个服务可以*单独测试*。
* 缺点：
  * 由于强调互相独立和低耦合，服务可能会拆分得很细。这导致系统*依赖大量的微服务，变得凌乱和笨重，性能也会不佳*。
  * 分布式处理使得微服务*较难实现原子性操作*，交易回滚会比较困难。

# 软件架构模式

## 软件架构模式概述

* 软件架构模式就是针对特定需求问题及其环境，所给出通用的软件架构设计解决方案。
* 软件架构风格与软件架构模式的对应关系：
  ![PrYL5L](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/PrYL5L.png)
* 软件架构模式意义：
  * 使得软件工程成熟的架构设计方案可以被*复用*，避免重复“发明车轮”的工作。
  * 架构模式为软件重构和软件工程*复用提供了技术支撑*。
  * 基于架构模式方法设计软件系统，可以*节省开发成本，提高软件开发效率*。
  * 在软件系统设计中，使用架构模式方法，还可以提高设计系统*质量*。
* 软件架构模式模版：
  ![KA2CiU](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/KA2CiU.png)
* 软件架构模式应用方式：
  ![tYEMLT](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/tYEMLT.png)

## 软件架构结构模式

* 代理者模式
* 集中控制模式
* 分布式控制模式
* 多层控制模式
* 抽象分层模式
* 多客户端/单服务模式
* 多客户端/多服务模式
* 多层客户端/服务模式

### 代理者模式

* 在代理者模式的软件架构中，需要使用代理者扮演客户端和服务端的*中介角色*。 
* 代理者使得客户端不再需要知道某个服务在哪里，就可以获得这个服务，从而使得客户端可以方便地*定位服务*。
* 模式图：
  ![x6Yk1O](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/x6Yk1O.png)

### 集中式控制模式

* 在集中式控制模式的软件架构中，*中央控制构件*按照特定对象状态机逻辑对系统全局行为进行控制操作。
* 中央控制构件*接收输入构件或用户界面构件的输入*操作。
* 中央控制构件根据输入事件引发的*系统状态变迁*，对相关部件实施操作控制，从而实现系统功能控制。
* 模式图：
  ![V9jS8l](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/V9jS8l.png)

### 分布式控制模式

* 在分布式控制模式的软件架构中，系统控制分布在多个控制构件之中，*不存在总控全局*的单一构件。
* 每个控制构件按照特定对象状态机逻辑*对系统特定部分的行为进行控制*操作。
* 多个控制构件通过*消息通信协作*完成整个系统的控制处理。
* 模式图：
  ![s6TIuJ](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/s6TIuJ.png)

### 多层控制模式

* 在多层控制模式的软件架构中系统*控制分布在多个控制构件*之中，此外，通过*协调者构件控制所有控制构件*实现整个系统的控制。
* 协调者构件提供全局控制，而每个控制构件按照特定对象状态机逻辑对系统特定部分的行为进行控制操作。
* 协调者控件发布命令到各个控制构件执行控制操作，同时协调者控件也从控制构件接收状态消息。
* 模式图：
  ![UsfAnf](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/UsfAnf.png)

### 抽象分层模式

* 在抽象分层模式的软件架构中，复杂的软件构件关系被*抽象到不同的功能层次*。
* 每个层次构件只能*访问它的相邻下层服务，同时也只对相邻的上层提供服务*。
* 层次之间通过*请求调用、返回响应消息*方式进行交互。
* 模式图：
  ![YXzCQP](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/YXzCQP.png)
* 示例：
  ![dRAamt](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/dRAamt.png)

### 多客户/单服务模式

* 在多客户/单服务模式的软件架构中，软件构件被*部署到多个客户端结点和一个服务端结点*。
* 各客户端结点的软件构件通过*网络连接访问服务端*结点上运行的服务。
* 该模式支持多个客户端构件向一个服务端构件提出服务请求，服务端构件将处理结果返回给请求的客户端构件。
* 模式图：
  ![S30qlG](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/S30qlG.png)

### 多客户/多服务模式

* 在多客户/多服务模式的软件架构中，软件构件被部署到多个客户端结点和*多个服务端*结点上运行。
* 客户端构件通过网络连接访问多个服务器结点上运行的服务。
* 支持多个客户端构件向多个服务端构件提出服务请求，服务端构件将处理结果返回给请求的客户端构件。
* 模式图：
  ![5rA8S0](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/5rA8S0.png)

### 多层客户/服务模式

* 在多层客户/服务模式的软件架构中，除了基本的客户端层次和服务端层次外，还有一个*同时扮演客户端角色和服务端角色的中间层*。
* 中间层对于它的服务层而言是一个客户端但对其他客户端而言又是一个服务端。
* 客户端、中间层、服务端的结点*通过网络连接到在一起*，支持多个客户端构件向服务端构件提出服务请求，服务端构件将处理结果返回给请求的客户端构件。
* 模式图：
  ![3BpNsH](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/3BpNsH.png)
* 示例：
  ![47ZJH3](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/47ZJH3.png)

## 软件架构通信模式

* 调用/返回模式
* 异步消息通信模式
* 同步消息通信模式
* 服务注册、转发、发现模式
* 广播/组播模式

### 调用/返回模式

* 在软件构件之间的通信交互中，一种常见的交互模式就是调用/返回模式。
* 一个*客户构件对象的操作方法去调用服务构件对象的操作方法*。
* 当服务构件对象的操作方法执行后，将*处理结果返回*客户构件对象。

### 异步消息通信模式

* 在软件构件的对象交互通信中，生产者构件进程可以独立于消费者构件运行。
* 一个构件中对象发送一个消息给另一个构件的对象，其*发送者不需要等待对方回复可以继续执行其他操作*。

### 同步消息通信模式

* 一个构件中对象发送一个消息给另一个构件的对象，*需要等待对方回复*，才可继续执行其他操作。
* 若发送消息的构件对象没有收到接收构件对象的回复消息，其进程将会挂起。

### 服务注册、转发、发现通信模式

* 服务注册、转发、发现通信模式应用于*面向服务的软件架构中，各个服务构件能够分布在多个结点*上运行。
* 这些*服务构件在代理构件的协助下能够被客户构件所访问*。
* *代理构件扮演客户构件和服务构件的中介*，它使客户构件不需要知道某个服务在哪里提供，而是通过代理构件便能获得服务构件的位置信息。
* 服务注册模式：
  ![hrrGWS](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/hrrGWS.png)
* 服务代理转发模式：
  ![E65Zjc](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/E65Zjc.png)
* 服务发现通信模式：客户端先向代理查询可用的服务，再请求服务
  ![T4OJgM](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/T4OJgM.png)

### 广播/组播通信模式

* 广播/组播消息通信模式适合于分布式应用。有一些分布式应用需要*将一个构件消息同时发送到多个构件处理*。
* 广播模式：一个构件发其余全部构件接受
  ![iRNFNt](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/iRNFNt.png)
* 组播模式：一个构建发特定的多个构件才能接受
  ![zNSTR9](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/zNSTR9.png)

## 软件架构事务模式

* 两阶段提交协议模式
* 复合事务模式
* 长事务模式

### 两阶段提交协议模式

* 两阶段提交协议模式用于分布式系统中*原子事务处理*，即确保事务所封装的服务请求操作是不可分割的，它们要么都完成，要么都取消。
* 在两阶段提交协议模式中，通过一个*提交协调构件*(commi tCoordinator )与多个服务构件进行通信协调，实现事务处理。
* 概念图：
   ![LV4NsH](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/LV4NsH.png)
* 投票为第一阶段:
  1. 协调者（Coordinator，即事务管理器）会向事务的参与者（Cohort，即本地资源管理器）发起执行操作的 CanCommit 请求，并等待参与者的响应.
  2. 参与者接收到请求后，会执行请求中的事务操作，记录日志信息(包含事务执行前的镜像)，同时锁定当前记录。参与者执行成功，则向协调者发送“Yes”消息，表示同意操作；若不成功，则发送“No”消息，表示终止操作。
  3. 当所有的参与者都返回了操作结果（Yes 或 No 消息）后，系统进入了提交阶段。
* 提交为第二阶段：
  * 协调者会根据所有参与者返回的信息向参与者发送 DoCommit 或 DoAbort 指令
  * 若协调者收到的都是“Yes”消息，则向参与者发送“DoCommit”消息，参与者会完成剩余的操作并释放资源，然后向协调者返回“HaveCommitted”消息；
  * 如果协调者收到的消息中包含“No”消息，则向所有参与者发送“DoAbort”消息，此时发送“Yes”的参与者则会根据之前执行操作时的回滚日志对操作进行回滚，然后所有参与者会向协调者发送“HaveCommitted”消息；
  * 协调者接收到“HaveCommitted”消息，就意味着整个事务结束了。

### 复合事务模式

* 在复杂业务处理中，当一个事务可以被分解为若干更小的、独立的处理单元时，这种事务就是复合事务。
* 示例：
  ![XtBLkH](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/XtBLkH.png)

### 长事务模式

* 在业务处理中，若需要*用户参与决策操作*，则会出现较长时间的数据资源锁定处理，这样的事务称为长事务。
* 示例：
    ![UfJcFs](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/UfJcFs.png)

# 软件架构UML建模设计

* 软件架构建模分为动态交互模型（通信图），静态结构模型（类图）和物理结构模型（构件图）。

## 软件架构静态结构模型

* 软件架构的静态结构模型(如UML 类图、UML 包图等)用于描述软件系统的*静态逻辑结构*。
* 类图：在面向对象系统设计中，软件架构采用UML设计类图模型将软件系统的类程序组成结构可视化呈现出来。
  * 类图(Class Diagram)描述一个系统的类程序静态逻辑组成结构。
  * 表示系统中类与类之间的关系，以及系统各个类的属性与操作组成。
  * 示例：
    ![OiFnND](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/OiFnND.png)
* 包图：在一个复杂系统的软件设计中，仅采用一个类图来反映系统的软件静态结构是不现实的。需要将复杂系统划分设计为相互联系的若干子系统。针对各个子系统，*分别给出它们的类图设计，并在高层设计中采用UML包图对系统的软件静态结构进行抽象设计*。
  * 包图( Package Diagram )是采用*类似文件夹的包符号*表示模型元素的组织结构模型图。
  * 包被描述成文件夹，可以应用在任何一种UML图上。
  * 系统中的*每个元素都只能为一个包所有，一个包可嵌套在另一个包中*。
  * 示例：
    ![jm4x5G](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/jm4x5G.png)

## 软件架构的动态交互行为模型

* 软件架构的动态交互行为模型用于反映软件系统的*对象之间交互行为*。
* UML通信图：在UML软件建模设计中，可以采用UML通信图描述软件对象之间的协作通信，从而反映对象之间通过动态消息交互行为实现系统功能。
  * 通信图( Communication Diagram)是表现对象间*直接交互关系*的模型图。
  * 它展现了多个对象在协同工作达成共同目标的过程中*互相通信*的情况。
  * 通过*对象和对象之间的链接、发送的消息*来显示对象之间的交互关系。
  * 示例：
    ![tQ42DB](https://gitee.com/zhangjie0524/picgo/raw/master/uPic/tQ42DB.png)

## 软件架构的物理结构模型

* 软件架构的物理结构模型用于反映软件系统结构的实现方案。在面向对象系统设计中，软件架构采用UML构件图和UML部署图表示系统物理结构实现方案。
* 构件图：
  * 构件图( Component Diagram )是描述系统的构件结构及其关系的模型图。
  * 描述软件的物理结构，从而支持基于构件的软件实现。
  * 示例：
    ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211102125126.png)
* 部署图：
  * 部署图(DeploymentDiagram)是表示系统构件*在环境结点中*的部署方案。
  * 从部署图还可以获知*软件和硬件组件之间*的物理拓扑、连接关系以及处理节点的分布情况。
  * 示例：
    ![](https://zjpicture.oss-cn-beijing.aliyuncs.com/img/20211102125520.png)



























